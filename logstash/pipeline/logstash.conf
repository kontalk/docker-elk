input {
    tcp {
        port => 5000
    }
    gelf {
        port => 12201
        codec => multiline {
            pattern => "^%{TIMESTAMP_ISO8601} "
            negate => true
            what => "previous"
        }
    }
}

filter {
    grok {
        patterns_dir => ["/usr/share/logstash/pipeline/patterns"]
        match => {
            "message" => "%{TIMESTAMP_ISO8601:timestamp} \[%{THREADNAME:thread_name}\]%{SPACE}%{JAVACLASS2:java_method}\(\)%{SPACE}%{LOGLEVEL2:log_level}:%{SPACE}%{GREEDYDATA:log_message}"
        }
    }
    kv {
        target => "properties"
    }
}

output {
    elasticsearch {
        hosts => "elasticsearch:9200"
    }
}
